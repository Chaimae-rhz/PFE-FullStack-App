<div *ngIf="user && !editing" class="profile-container">
  <mat-card class="profile-card">
    <mat-card-header class="animated-header">
      <mat-card-title>Profil</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <p><strong>Nom d'utilisateur :</strong> {{ user.username }}</p>
      <p><strong>Nom :</strong> {{ user.lastName }}</p>
      <p><strong>Prénom :</strong> {{ user.firstName }}</p>
      <p><strong>Email :</strong> {{ user.email }}</p>
      <p><strong>Numéro de téléphone :</strong> {{ user.phoneNumber }}</p>
      <p><strong>Rôle :</strong> {{ user.role }}</p>
      <p><strong>Filière :</strong> {{ user.programeId }}</p>

      <p><strong>Date d'inscription :</strong> {{ user.dateInscription | date:'dd-MM-yy' }}</p>
    </mat-card-content>
    <mat-card-actions>
      <button mat-raised-button color="primary" class="animated-button" (click)="onEdit()">Modifier</button>
    </mat-card-actions>
  </mat-card>
</div>

<div *ngIf="editing" class="profile-container">
  <mat-card class="profile-card">
    <mat-card-header class="animated-header">
      <mat-card-title>Modifier le profil</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <mat-form-field appearance="fill">
          <mat-label>Nom</mat-label>
          <input matInput formControlName="lastName" required>
          <mat-error *ngIf="profileForm.get('lastName')?.hasError('required')">Le nom est requis</mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Prénom</mat-label>
          <input matInput formControlName="firstName" required>
          <mat-error *ngIf="profileForm.get('firstName')?.hasError('required')">Le prénom est requis</mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" required>
          <mat-error *ngIf="profileForm.get('email')?.hasError('required')">L'email est requis</mat-error>
          <mat-error *ngIf="profileForm.get('email')?.hasError('email')">Format d'email invalide</mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Mot de passe</mat-label>
          <input matInput [type]="passwordVisible ? 'text' : 'password'" formControlName="password">
          <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
            <mat-icon>{{ passwordVisible ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Confirmer le mot de passe</mat-label>
          <input matInput [type]="passwordVisible ? 'text' : 'password'" formControlName="confirmPassword">
          <mat-error *ngIf="profileForm.get('confirmPassword')?.value !== profileForm.get('password')?.value">
            Les mots de passe ne correspondent pas
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Numéro de téléphone</mat-label>
          <input matInput formControlName="phoneNumber" required>
          <mat-error *ngIf="profileForm.get('phoneNumber')?.hasError('required')">Le numéro de téléphone est requis</mat-error>
          <mat-error *ngIf="profileForm.get('phoneNumber')?.hasError('pattern')">Format de numéro de téléphone invalide</mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Rôle</mat-label>
          <input matInput formControlName="Role" [attr.disabled]="true">
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Filière :</mat-label>
          <input matInput formControlName="programeId" required>
          <mat-error *ngIf="profileForm.get('programeId')?.hasError('required')">L'ID du programme est requis</mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Date d'inscription</mat-label>
          <input matInput formControlName="dateInscription" [attr.disabled]="true" [value]="user?.dateInscription | date:'dd-MM-yy'">
        </mat-form-field>
        <mat-card-actions>
          <button mat-raised-button color="primary" type="submit">Enregistrer</button>
          <button mat-button type="button" (click)="onCancel()">Annuler</button>
        </mat-card-actions>
      </form>
    </mat-card-content>
  </mat-card>
</div>
